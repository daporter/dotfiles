#!/bin/sh

# Use the 1password cli program 'op' to retrieve the password for the given
# item.  This requires that I've first logged in:
#   $ eval $(op signin example)

if [ $# -ne 1 ]; then
    PROGNAME=$(basename "$0")
    printf "Usage %s <item_name>\n" "$PROGNAME"
    exit 1
fi

item=$(op get item "$1") 
if [ $? = 1 ]; then
    item=$(op signin porter_speckmann --output=raw | op get item "$1")
fi

echo "$item" | \
    jq --raw-output '.details.fields[] | select(.designation=="password").value'
