#!/bin/sh
#
# Perform a web search using the specified search engine.  

usage () {
	echo "Usage: $0 [-p] --google|--wikipedia|--oxford|--onelook|--wordreference"
	exit 1
}

_check() {
	command -v "$1" > /dev/null
}

if [ "$1" = '-p' ]; then
	TERM=$(zenity --entry --text 'Search term:')
	if [ $? != 0 ]; then
		# “Cancel” pressed.
		exit
	fi
	shift
else
	TERM=$(xclip -o)
fi

for program in zenity xclip xdg-open; do
	if ! _check $program; then
		printf 'Error: %s not found' "$program"
		exit 1
	fi
done

case $1 in
	--google)
		URI="https://www.google.com/search?q=$TERM"
		;;
	--wikipedia)
		URI="https://en.wikipedia.org/wiki/$TERM"
		;;
	--googlemaps)
		URI="https://www.google.com/maps/place/$TERM"
		;;
	--oxford)
		URI="https://www.lexico.com/definition/$TERM"
		;;
	--onelook)
		URI="https://onelook.com/?w=$TERM"
		;;
	--wordreference)
		URI="https://www.wordreference.com/fren/$TERM"
		;;
	*)
		usage
esac

xdg-open "$URI"
