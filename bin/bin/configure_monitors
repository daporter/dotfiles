#!/bin/sh
#
# Connect to or disconnect from an external monitor.
#
# NOTE: Assumes the external monitor is connected via DisplayPort and
# named DP-1.

_check() {
	command -v "$1" > /dev/null
}

_external_is_connected () {
	xrandr --query | grep -q 'DP-1 connected'
}

_external () {
	xrandr --output DP-1 \
	       --mode 1920x1080 \
	       "$@"
}

_laptop () {
	xrandr --output LVDS-1 \
	       --mode 1600x900 \
	       "$@"
}

_reconfigure_wallpaper () {
	"$HOME"/.fehbg
}

if ! _check xrandr; then
	echo "Error: xrandr not found"
	exit 1
fi

if _external_is_connected; then
	_external --primary
	_laptop
else
	_laptop --primary
	_external --off
fi

_reconfigure_wallpaper
