# Refer to the wiki for more information.
# https://wiki.hypr.land/Configuring/

#         name, resolution, position, scale
monitor = DP-1, 2560x1440@120Hz, auto, 1

exec-once = hyprpaper
exec-once = waybar
exec-once = hypridle
exec-once = wlsunset -l -35.3 -L 149.1 -t 3700 -T 5500

exec-once = swaync
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=Hyprland
exec-once = hyprctl setcursor Nordzy-cursors-white 24

# From instructions at https://wiki.hypr.land/Hypr-Ecosystem/hyprpolkitagent/
exec-once = systemctl --user start hyprpolkitagent

exec-once = 1password --silent
exec-once = emacs --daemon

exec-once = gnome-keyring-daemon --start --components=secrets

env = SSH_AUTH_SOCK, $XDG_RUNTIME_DIR/gcr/ssh

exec-once = goldendict --group-name Main --popup-group-name Popup
env = GOLDENDICT_FORCE_WAYLAND, 1

# Launch a terminal on the scratchpad.
exec-once = kitty --title scratchpad

env = XCURSOR_THEME,            Nordzy-cursors-white
env = XCURSOR_SIZE,             24
env = HYPRCURSOR_THEME,         Nordzy-cursors-white
env = HYPRCURSOR_SIZE,          24
env = QT_QPA_PLATFORMTHEME,     qt6ct

# Force all apps to use Wayland
env = GDK_BACKEND,                      wayland,x11,*
env = QT_QPA_PLATFORM,                  wayland;xcb
env = SDL_VIDEODRIVER,                  wayland
env = MOZ_ENABLE_WAYLAND,               1
env = ELECTRON_OZONE_PLATFORM_HINT,     wayland
env = OZONE_PLATFORM,                   wayland
env = XDG_SESSION_TYPE,                 wayland

# Allow better support for screen sharing (Google Meet, Discord, etc)
env = XDG_CURRENT_DESKTOP,              Hyprland
env = XDG_SESSION_DESKTOP,              Hyprland

# Font rendering
env = FREETYPE_PROPERTIES,              truetype:interpreter-version=38
env = GDK_SCALE,                        1
env = GDK_DPI_SCALE,                    1
env = QT_AUTO_SCREEN_SCALE_FACTOR,      1
env = QT_SCALE_FACTOR,                  1

general {
    gaps_in             = 3
    gaps_out            = 6
    border_size         = 2
    resize_on_border    = true
    col.active_border   = rgba(93a1a1ff)
    col.inactive_border = rgba(eee8d5ff)

    layout              = dwindle
}

input {
    kb_options      = compose:menu
    repeat_rate     = 90
    repeat_delay    = 300

    accel_profile   = flat
    scroll_factor   = 0.25
    natural_scroll  = true
}

misc {
    force_default_wallpaper         = 0
    animate_manual_resizes          = true
    animate_mouse_windowdragging    = true
    focus_on_activate               = true
}

cursor {
    hide_on_key_press   = true
}

dwindle {
    force_split = 2             # to the right or below
}

#
# KEYBINDINGS
#

# Window focus.
bind = Super,   A,  movefocus, l
bind = Super,   E,  movefocus, u
bind = Super,   I,  movefocus, d
bind = Super,   H,  movefocus, r

# Workspaces.
bind = Super,   1,          workspace,  1
bind = Super,   2,          workspace,  2
bind = Super,   3,          workspace,  3
bind = Super,   4,          workspace,  4
bind = Super,   5,          workspace,  5
bind = Super,   6,          workspace,  6
bind = Super,   7,          workspace,  7
bind = Super,   8,          workspace,  8
bind = Super,   9,          workspace,  9
bind = Super,   K,          workspace, +1
bind = Super,   U,          workspace, -1
bind = Super,   Tab,        workspace, previous
bind = Super,   mouse_up,   workspace, +1
bind = Super,   mouse_down, workspace, -1

# Window movement.
bind    = Super+Shift,  A,          swapwindow, l
bind    = Super+Shift,  E,          swapwindow, u
bind    = Super+Shift,  I,          swapwindow, d
bind    = Super+Shift,  H,          swapwindow, r
bindm   = Super,        mouse:272,  movewindow

# Move to workspace.
bind = Super+Shift,     1,  movetoworkspace,  1
bind = Super+Shift,     2,  movetoworkspace,  2
bind = Super+Shift,     3,  movetoworkspace,  3
bind = Super+Shift,     4,  movetoworkspace,  4
bind = Super+Shift,     5,  movetoworkspace,  5
bind = Super+Shift,     6,  movetoworkspace,  6
bind = Super+Shift,     7,  movetoworkspace,  7
bind = Super+Shift,     8,  movetoworkspace,  8
bind = Super+Shift,     9,  movetoworkspace,  9
bind = Super+Shift,     K,  movetoworkspace, +1
bind = Super+Shift,     U,  movetoworkspace, -1

# Applications.
bind = Super,               Space,      exec, wofi --show drun
bind = Super+Ctrl,          Space,      exec, 1password --quick-access
bind = Super,               Return,     exec, kitty
bind = Super,               B,          exec, firefox --new-window
bind = Super+Ctrl,          D,          exec, goldendict --popup $(wl-paste --primary --no-newline)
bind = Super+Ctrl,          E,          exec, emacsclient --create-frame --no-wait --alternate-editor='' --quiet
bind = Super+Ctrl,          S,          exec, hyprshot -m window
bind = Super+Ctrl+Shift,    S,          exec, hyprshot -m region
bind = Super,               slash,      exec, firefox --new-window ~/.config/hypr/keybindings.html

# Window resizing.
binde = Super+Ctrl,         A,          resizeactive, -20   0
binde = Super+Ctrl,         E,          resizeactive,   0 -20
binde = Super+Ctrl,         I,          resizeactive,   0  20
binde = Super+Ctrl,         H,          resizeactive,  20   0
bindm = Super,              mouse:273,  resizewindow

# layout (Dwindle).
bind = Super,               F,          fullscreen, 1 toggle
bind = Super+Ctrl,          F,          fullscreen, 0 toggle
bind = Super+Shift,         Space,      togglefloating
bind = Super+Shift,         mouse:272,  togglefloating
bind = Super,               W,          killactive
bind = Super,               P,          pin

# Scratchpad.
bind = Super,               S,          togglespecialworkspace, magic
bind = Super+Ctrl,          T,          exec, kitty --title scratchpad

# Compositor
bind = Super+Shift,         Escape,     exit

#
# WINDOW RULES
#

windowrulev2    = suppressevent maximize, class:.*

windowrulev2    = workspace 3, class:^(obsidian)$

# GoldenDict popup: float and centre.
windowrulev2    = float,        class:.*goldendict_ng$, title:.* - GoldenDict-ng$
windowrulev2    = center,       class:.*goldendict_ng$, title:.* - GoldenDict-ng$
windowrulev2    = size 800 600, class:.*goldendict_ng$, title:.* - GoldenDict-ng$

# Move a terminal with the class "scratchpad" to the special workspace. The
# "magic" tag corresponds to the keybinding above.
windowrulev2    = workspace special:magic,      class:^(kitty)$, title:^(scratchpad)$
windowrulev2    = float,                        class:^(kitty)$, title:^(scratchpad)$
windowrulev2    = size 50% 50%,                 class:^(kitty)$, title:^(scratchpad)$
windowrulev2    = center,                       class:^(kitty)$, title:^(scratchpad)$

# The Hyprland keybindings cheatsheet.
# Note that these rules to make the window float don’t currently work. AIUI,
# this is due to how Firefox sets the window title. Nevertheless, I’ll leave the
# rules here in case it happens to start working one day.
windowrulev2    = float,        class:^(firefox)$, title:^(Hyprland Keybindings Reference)
windowrulev2    = size 60% 80%, class:^(firefox)$, title:^(Hyprland Keybindings Reference)
windowrulev2    = center,       class:^(firefox)$, title:^(Hyprland Keybindings Reference)
