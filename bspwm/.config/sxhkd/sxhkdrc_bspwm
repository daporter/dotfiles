#
# SXHKD module with BPSWM-specific commands
# ======================================================================

# Close {or kill} currently focused node
mod3 + {_,shift + }q
	bspc node -{c,k}

# ............................................ Focus/swap nodes/desktops

# mod3 + <number> = focus the given desktop
# mod3 + shift + <number> = send focused window to given desktop
mod3 + {_,shift + }{1-9}
	bspc {desktop -f,node -d} '^{1-9}'
         
# Switch to the {next,previous} monitor. This brings focus to that
# monitor's active desktop.
mod3 + {_,shift + }comma
	bspc monitor -f {next,prev}

# Swap current window with the biggest one in the present desktop.
mod3 + shift + b
	bspc node -s biggest.local

# Focus the node in the given direction.
mod3 + {h,j,k,l}
	bspc node -f {west,south,north,east}

# Swap focused window with the one in the given direction.
mod3 + shift + {h,j,k,l}
	bspc node -s {west,south,north,east}

# With `alt` focus {next,previous} window in the current desktop. With
# `mod3` focus {next,previous} desktop in the current monitor. Cyclical
# behaviour. Move in the opposite direction while also holding down
# `shift`.
{mod3,alt} + {_,shift +} Tab
	bspc {desktop,node} -f {next,prev}.local

# Switch to the other monitor.
mod3 + o
	bspc monitor -f next

# Switch to last active {desktop,node}. With mod3 move to the last
# active desktop. With alt move to the last active node. "grave" is
# positioned above Tab in QWERTY layouts.
{mod3,alt} + grave
	bspc {desktop,node} -f last

# Move a floating window with the arrow keys (else use Alt + Left Mouse
# Click to drag). I seldom use floating windows.
mod3 + shift + {Left,Down,Up,Right}
	bspc node -v {-20 0,0 20,0 -20,20 0}

# Preselect the direction or insert again to cancel the preselection.
# This enters the manual tiling mode that splits the currently focused
# window.
mod3 + alt + {h,j,k,l}
	bspc node --presel-dir '~{west,south,north,east}'

# Preselect the ratio. The default value is 0.5, defined in `bspwmrc`.
mod3 + alt + {1-9}
	bspc node -o 0.{1-9}

# .......................................................... Node layout

mod3 + t
    bspc node --state tiled ; \
    bspc desktop --layout tiled && \
    panel_unhide
mod3 + m
	bspc node --state tiled ; \
    bspc desktop --layout monocle ; \
    panel_unhide
mod3 + f
    bspc node --state ~fullscreen && \
    panel_toggle
mod3 + space
	bspc node --state ~floating

# Set the node flags. Locked is a node that cannot be closed with `bspc
# node --close`. Marked is a specific selector that allows operating
# on the given item (such as sending the marked item to the newest
# preselection). Sticky stays in the focused desktop. Private tries to
# keep its dimensions and tiling position.
mod3 + a ; {l,m,s,p}
	bspc node -g {locked,marked,sticky,private}

# ............................................................ Workspace

# Rotate all windows {counter-}clockwise by 90 degrees.
mod3 + {_,shift + }r
	bspc node @/ --rotate {90,-90}

# Dynamic gaps.
mod3 + shift + bracket{left,right}
	bspc config -d focused window_gap "$(($(bspc config -d focused window_gap) {-,+} 5 ))"

# Flip desktop: what is on the right/top moves to the left/bottom and
# vice versa.
mod3 + alt + {_,shift + }r
	bspc node @/ --rotate {180,-180}

# Switch between gap presets.
mod3 + shift + {y,u,i,o}
	bspc config window_gap {0,5,10,20}
